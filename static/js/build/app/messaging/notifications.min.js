!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,n){"use strict";var i=angular.module("general.directives",[]);i.directive("alerts",[function(){return{restrict:"E",scope:{messages:"="},templateUrl:Urls["messaging_api:partial_base"]()+"directive/alerts",link:function(e,t){t.find("button").bind("click",function(){e.$apply(function(){e.class="",e.msg=""})})},controller:["$scope",function(e){e.class="",e.setMessage=function(t){e.messages[t]&&(e.msg=e.messages[t],e.class="alert-"+t,e.messages={})},angular.forEach(["success","danger","warning","info"],function(t){e.$watch("messages."+t,function(){e.setMessage(t)},!0)})}]}}]),i.directive("modalConfirm",[function(){return{restrict:"E",scope:{uid:"@",title:"@",body:"@",cancel:"&",confirm:"&"},templateUrl:Urls["messaging_api:partial_base"]()+"directive/modalConfirm"}}]),i.directive("pagination",[function(){return{restrict:"E",scope:{perPage:"@",currentPage:"=",total:"=",fetchPage:"&"},templateUrl:Urls["messaging_api:partial_base"]()+"directive/pagination",controller:["$scope",function(e){e.currentPage=0,e.pageCount=0,e.pages=[],e.calculatePageCount=function(){0===e.total?e.pageCount=1:e.pageCount=Math.ceil(e.total/e.perPage)},e.calculatePages=function(){var t,n,i;for(t=1,n=e.pageCount,e.pages=[],i=t;i<=n;++i)e.pages.push(i)},e.$watch("currentPage",function(){e.calculatePages()}),e.$watch("total",function(){e.calculatePageCount(),e.calculatePages()}),e.prevPage=function(){e.currentPage>0&&--e.currentPage},e.prevPageDisabled=function(){var t=0===e.currentPage?"disabled":"";return t},e.nextPage=function(){e.currentPage<e.pageCount-1&&e.currentPage++},e.nextPageDisabled=function(){var t=e.currentPage===e.pageCount-1?"disabled":"";return t},e.pageDisabled=function(t){var n=e.currentPage===t;return n},e.gotoPage=function(t){e.currentPage=t}}]}}])},function(e,t,n){"use strict";var i=angular.module("general.filters",[]);i.filter("raw",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}])},function(e,t,n){"use strict";var i=angular.module("general.services",[]);i.service("genericSrv",["$http","$q",function(e,t){this.genericGet=function(e){return this._genericVerb("get",e,{})},this.genericPost=function(e,t){return this._genericVerb("post",e,t)},this._genericVerb=function(n,i,r){var a=t.defer();return e[n](i,r).success(function(e){a.resolve(e)}).error(function(e){a.reject(e)}),a.promise}}]),i.service("messageSrv",function(){this.messages={},this.collect=function(){var e={};return angular.copy(this.messages,e),this.messages={},e}})},function(e,t,n){"use strict";var i=angular.module("notificationsApp",["notificationsApp.controllers","notificationsApp.services","general.directives","general.filters","general.services","ngRoute","ngSanitize"]);i.constant("CONFIG",window.CONFIG),delete window.CONFIG,i.config(["$routeProvider","$httpProvider",function(e,t){t.defaults.xsrfCookieName="csrftoken",t.defaults.xsrfHeaderName="X-CSRFToken",t.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e.when("/",{templateUrl:Urls["messaging_api:partial_base"]()+"route/listNotifications",controller:"listNotificationsCtrl"}).otherwise({redirectTo:"/"})}])},function(e,t,n){"use strict";var i=angular.module("notificationsApp.controllers",[]);i.controller("listNotificationsCtrl",["$scope","$timeout","$window","genericSrv","messageSrv","CONFIG",function(e,t,n,i,r,a){e.perPage=6,e.notifications=null,e.total=0,e.currentPage=0,e.timeoutPromise=null,e.messages=r.collect(),e.showMessageItemIds=a.showMessageItemIds,e.firstTime=!0,e.getPageOfNotifications=function(){var n=Urls["messaging_api:get_notifications"]()+"?page="+e.currentPage+"&per_page="+e.perPage;t.cancel(e.timeoutPromise),i.genericGet(n).then(function(t){e.notifications=t.notifications,e.total=t.total,e.firstTime&&0===e.total&&(e.firstTime=!1,e.messages.info=a.trans.no_notifications)},function(t){e.notifications=null,e.total=0,e.messages.danger=t.errorMessage}).finally(function(){e.timeoutPromise=t(function(){e.getPageOfNotifications(e.currentPage)},1e4)})},e.clickNotification=function(t){var r=Urls["messaging_api:mark_notification_read"]()+"?miid="+t.id;i.genericGet(r).then(function(){n.location.href=t.url},function(t){e.messages.danger=t.errorMessage})},e.openModal=function(n,i,r){n.stopPropagation(),t.cancel(e.timeoutPromise),e.miid=r,jQuery("#"+i).modal({})},e.cancelDeleteNotification=function(t){var n=jQuery("#"+t);n.off("hidden.bs.modal"),n.on("hidden.bs.modal",function(){e.getPageOfNotifications(e.currentPage)}),n.modal("hide")},e.deleteNotification=function(t){var n,r=jQuery("#"+t);r.off("hidden.bs.modal"),r.on("hidden.bs.modal",function(){var t=e.miid;e.miid=null,t&&(n=Urls["messaging_api:delete_message_item"]()+"?miid="+t,i.genericGet(n).then(function(t){e.messages.success=t.successMessage,e.currentPage=0},function(t){e.messages[t.type]=t.errorMessage}).finally(function(){e.getPageOfNotifications(e.currentPage)}))}),r.modal("hide")},e.$watch("currentPage",function(t){e.getPageOfNotifications(t)}),e.$on("$destroy",function(){t.cancel(e.timeoutPromise)})}])},function(e,t,n){"use strict";angular.module("notificationsApp.services",[])},function(e,t,n){"use strict";n(3),n(4),n(5),n(0),n(1),n(2)}]);
//# sourceMappingURL=notifications.min.js.map